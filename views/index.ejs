

<h1 class="text-center mb-4"><i class="fa-solid fa-bolt text-primary me-2"></i>Berita Terbaru</h1>

<!-- Filter -->
<form method="GET" action="/" class="row g-3 mb-4 bg-white p-3 rounded shadow-sm">
  <div class="col-md-4">
    <input type="text" name="search" class="form-control" placeholder="Cari berita..." value="<%= search || '' %>">
  </div>
  <div class="col-md-3">
    <select name="category" class="form-select">
      <option value="">Semua Kategori</option>
      <% categories.forEach(cat => { %>
        <option value="<%= cat %>" <%= cat===selectedCategory?'selected':'' %>><%= cat %></option>
      <% }) %>
    </select>
  </div>
  <div class="col-md-3">
    <select name="tag" class="form-select">
      <option value="">Semua Tags</option>
      <% tags.forEach(t => { %>
        <option value="<%= t %>" <%= t===selectedTag?'selected':'' %>><%= t %></option>
      <% }) %>
    </select>
  </div>
  <div class="col-md-2 d-grid">
    <button type="submit" class="btn btn-primary"><i class="fa-solid fa-filter me-1"></i>Filter</button>
  </div>
</form>

<div class="row">
  <!-- Daftar Berita -->
  <div class="col-lg-8">
    <div class="row">
      <% if(posts && posts.length > 0){ %>
        <% posts.forEach(post => { %>
          <div class="col-md-6 mb-4">
            <div class="card h-100 border-0 shadow-sm">
              <% if(post.image){ %>
                <img src="<%= post.image %>" class="card-img-top" alt="<%= post.title %>">
              <% } %>
              <div class="card-body">
                <h5 class="card-title text-primary fw-semibold"><%= post.title %></h5>
                <p class="small text-muted mb-2">
                  <i class="fa-solid fa-tag me-1"></i><%= post.category %> • 
                  <i class="fa-solid fa-user me-1"></i><%= post.author %> • 
                  <i class="fa-regular fa-calendar me-1"></i><%= new Date(post.created_at).toLocaleDateString() %>
                </p>
                <p class="card-text"><%= post.content.substring(0,100) %>...</p>
              </div>
              <div class="card-footer bg-white border-0 text-end">
                <a href="/post/<%= post.slug %>" class="btn btn-outline-primary btn-sm">
                  Baca Selengkapnya <i class="fa-solid fa-arrow-right-long ms-1"></i>
                </a>
              </div>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <p class="text-center text-muted">Tidak ada berita ditemukan.</p>
      <% } %>
    </div>

    <!-- Pagination -->
    <nav aria-label="Halaman">
      <ul class="pagination justify-content-center mt-4">
        <% for(let i=1; i<=totalPages; i++){ %>
          <li class="page-item <%= i===page ? 'active' : '' %>">
            <a class="page-link" href="?page=<%= i %>&search=<%= search %>&category=<%= selectedCategory %>"><%= i %></a>
          </li>
        <% } %>
      </ul>
    </nav>
  </div>

  <!-- Sidebar Trending -->
  <div class="col-lg-4">
    <div class="bg-white p-3 rounded shadow-sm sticky-top" style="top: 1rem;">
      <h4 class="fw-bold border-bottom pb-2 mb-3"><i class="fa-solid fa-fire text-danger me-2"></i>Trending</h4>
      <% trending.forEach(tr => { %>
        <div class="mb-3 border-bottom pb-2">
          <a href="/post/<%= tr.slug %>" class="text-decoration-none text-dark fw-semibold d-block mb-1">
            <%= tr.title %>
          </a>
          <small class="text-muted"><i class="fa-regular fa-eye me-1"></i><%= tr.views %> views</small>
        </div>
      <% }) %>
    </div>
  </div>
</div>
